# Data-Traffic-Monitor

Wifi のデータ通信量制限に一度引っかかってしまったため、データ通信量を測定するスクリプトを作成しました。  
最初は Windows サービスにしようとしましたが、スクリプトをタスクスケジューラで定期実行した方が楽だと思い、スクリプトにしました。

## ■ タスクスケジューラ登録方法

- 1.タスクスケジューラを起動し、タスクの作成を選択  
  ![1](https://user-images.githubusercontent.com/49807271/224484039-31d491cf-dbed-4c42-b133-9f5b301a67bc.png)

- 2.タスク名称を入力。ログオフ状態でも動くように設定  
  ![2](https://user-images.githubusercontent.com/49807271/224484076-be6d6a07-2689-4de5-bedb-443946bfda83.png)

- 3.操作タブに切替、新規ボタンを選択。
  - スクリプト:pwsh
  - 引数の追加:-ExecutionPolicy Bypass スクリプトパス 測定対象ネットワークアダプタ名称

![3](https://user-images.githubusercontent.com/49807271/224484153-c8daef7d-1214-4dad-b6c4-afa38d64d4aa.png)

- 4.トリガータブに切り替え、新規ボタンを選択  
   _ 繰り返し間隔:1 時間
  _ 継続期間:無期限　
  ![4](https://user-images.githubusercontent.com/49807271/224484080-7db341cb-b729-4a6c-9127-c1214922df20.png)

以下のログファイルが出力されるので、加工してグラフ化するなりすれば、データ通信量の変化が見て取れるはずです。  
ここではテスト目的で 5 分置きに実行しています。  
あんまり気にしていなかったのですが、通信の統計値の算出期間があると思うので、切り替わりタイミングを考慮してやる必要がありそうです。

■ ネットワークアダプタ名称\_history.log
|取得日時|ダウンロードバイト|アップロードバイト|
|--|--|--|
|2023/03/11 22:00|1151676660bytes|75158295bytes|1226834955bytes|
|2023/03/11 22:01|1154376041bytes|75289939bytes|1229665980bytes|
|2023/03/11 22:06|1169964445bytes|77330390bytes|1247294835bytes|
|2023/03/11 22:11|1223798779bytes|80821999bytes|1304620778bytes|
|2023/03/11 22:16|1268214870bytes|83372947bytes|1351587817bytes|
|2023/03/11 22:21|1270594378bytes|84446771bytes|1355041149bytes|
|2023/03/11 22:26|1273844771bytes|85371836bytes|1359216607bytes|
|2023/03/11 22:31|1292653348bytes|87004251bytes|1379657599bytes|
|2023/03/11 22:36|1295100002bytes|87989337bytes|1383089339bytes|
|2023/03/11 22:41|1302354580bytes|88267606bytes|1390622186bytes|
|2023/03/11 22:46|1316084984bytes|89261164bytes|1405346148bytes|
|2023/03/11 22:51|1326184749bytes|90432366bytes|1416617115bytes|
